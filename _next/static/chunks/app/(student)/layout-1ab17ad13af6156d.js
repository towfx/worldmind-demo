(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[732],{4329:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});let r=(0,s(4168).A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]])},7706:(e,t,s)=>{"use strict";s.d(t,{l:()=>y});var r=s(2432),a=s(40208),n=s(80364),o=s(57910),c=s(46992),i=s(41823),d=s(84963);let l=o.Kq,u=n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.LM,{ref:t,className:(0,d.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",s),...a})});u.displayName=o.LM.displayName;let g=(0,c.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),m=n.forwardRef((e,t)=>{let{className:s,variant:a,...n}=e;return(0,r.jsx)(o.bL,{ref:t,className:(0,d.cn)(g({variant:a}),s),...n})});m.displayName=o.bL.displayName,n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.rc,{ref:t,className:(0,d.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",s),...a})}).displayName=o.rc.displayName;let f=n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.bm,{ref:t,className:(0,d.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",s),"toast-close":"",...a,children:(0,r.jsx)(i.A,{className:"h-4 w-4"})})});f.displayName=o.bm.displayName;let h=n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.hE,{ref:t,className:(0,d.cn)("text-sm font-semibold",s),...a})});h.displayName=o.hE.displayName;let p=n.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(o.VY,{ref:t,className:(0,d.cn)("text-sm opacity-90",s),...a})});function y(){let{toasts:e}=(0,a.dj)();return(0,r.jsxs)(l,{children:[e.map(function(e){let{id:t,title:s,description:a,action:n,...o}=e;return(0,r.jsxs)(m,{...o,children:[(0,r.jsxs)("div",{className:"grid gap-1",children:[s&&(0,r.jsx)(h,{children:s}),a&&(0,r.jsx)(p,{children:a})]}),n,(0,r.jsx)(f,{})]},t)}),(0,r.jsx)(u,{})]})}p.displayName=o.VY.displayName},21886:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(2432),a=s(92105);function n(){let{t:e}=(0,a.Bd)();return(0,r.jsx)("footer",{className:"bg-white border-t border-gray-200 py-4",children:(0,r.jsx)("div",{className:"container mx-auto px-4 text-center text-sm text-gray-500",children:e("login.copyright",{year:new Date().getFullYear()})})})}},40208:(e,t,s)=>{"use strict";s.d(t,{dj:()=>g});var r=s(80364);let a=0,n=new Map,o=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),l({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},c=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?o(s):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],d={toasts:[]};function l(e){d=c(d,e),i.forEach(e=>{e(d)})}function u(e){let{...t}=e,s=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>l({type:"DISMISS_TOAST",toastId:s});return l({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>l({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function g(){let[e,t]=r.useState(d);return r.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>l({type:"DISMISS_TOAST",toastId:e})}}},51988:(e,t,s)=>{Promise.resolve().then(s.bind(s,61019))},57834:(e,t,s)=>{"use strict";s.d(t,{HW:()=>u,M3:()=>l,TK:()=>i,iD:()=>d,kg:()=>c,kl:()=>n,lo:()=>o,ri:()=>g});var r=s(15616),a=s(9266);let n=async e=>(0,r.P)("users/".concat(e)),o=async e=>(0,r.P)("users",e),c=async e=>(0,r.vt)("users",e),i=async(e,t)=>(0,r.yo)("users",e,t),d=async(e,t)=>{if(console.log("[AUTH] Attempting login for:",e),"false"===a.env.NEXT_PUBLIC_USE_REMOTE_API)return console.log("[AUTH] Using mock login (remote API disabled)"),{success:!0,data:{token:"mock-token-".concat(Date.now()),name:"Mock User",email:e,user_id:"mock-user-123",roles:e.includes("admin")?["admin"]:["student"],logged_in_status:!0,loggedin_at:new Date().toISOString()}};try{let s=await (0,r.Qi)("auth/login","POST",{email:e,password:t});if(!s.success)throw Error(s.message||"Login failed. Please check your credentials.");console.log("[AUTH] Login successful:",s.data.name);let a={token:s.data.token,name:s.data.name,email:s.data.email,user_id:s.data.user_id,roles:s.data.roles,logged_in_status:s.data.logged_in_status,loggedin_at:s.data.loggedin_at};return localStorage.setItem("login_info",JSON.stringify(a)),{success:!0,data:a}}catch(e){if(console.error("[AUTH] Login failed:",e),"TypeError"!==e.name||"Failed to fetch"!==e.message)return{success:!1,message:e.message||"An error occurred during login. Please try again."};return console.log("[AUTH] Network error detected, falling back to mock login for development"),{success:!1,message:"Network error: Could not connect to the server. Please check your connection and try again."}}},l=()=>{try{let e=localStorage.getItem("login_info");if(!e)return!1;let{logged_in_status:t}=JSON.parse(e);return!!t}catch(e){return console.error("[AUTH] Error checking login status:",e),!1}},u=()=>{try{let e=localStorage.getItem("login_info");if(!e)return null;return JSON.parse(e)}catch(e){return console.error("[AUTH] Error getting current user:",e),null}},g=async()=>{try{await (0,r.Qi)("auth/logout","POST")}catch(e){console.error("[AUTH] Error during logout API call:",e)}finally{localStorage.removeItem("login_info"),localStorage.removeItem("student_info"),console.log("[AUTH] User logged out")}}},61019:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>S});var r=s(2432),a=s(80364),n=s(39262),o=s(32317),c=s.n(o),i=s(78988),d=s(41823),l=s(99894),u=s(94010),g=s(82811),m=s(4329),f=s(38452),h=s(94537),p=s(84652),y=s(62867),x=s(54260),v=s(17338),b=s(21886),w=s(7706),N=s(57834),A=s(69556),j=s(79737);function S(e){let{children:t}=e,s=(0,n.useRouter)(),o=(0,n.usePathname)(),[S,_]=(0,a.useState)(!1),[T,E]=(0,a.useState)(null),[k,O]=(0,a.useState)(null),[I,C]=(0,a.useState)(!1),P=()=>C(!1);return((0,a.useEffect)(()=>{console.log("[layout] initializeStudentLayout student info..."),(async()=>{if(_(!0),!(0,N.M3)()){s.push("/auth/login");return}let e=(0,N.HW)();if(!e||!e.roles.includes("student")){s.push("/auth/login");return}E(e);try{let e=(0,j.Qi)();e?console.log("[layout] Student info loaded from localStorage:",{id:e.id,name:e.name}):(console.log("[layout] Fetching current student info..."),e=await (0,A.Z1)(),(0,j._d)(e),console.log("[layout] Student info fetched and stored:",{id:e.id,name:e.name})),O(e)}catch(e){console.error("[layout] Failed to fetch student info:",e),s.push("/auth/login")}})()},[s]),S&&T&&k)?(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[(0,r.jsx)(v.A,{}),(0,r.jsx)("main",{className:"flex-grow",children:(0,r.jsx)("div",{className:"container py-8",children:(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-8",children:[(0,r.jsx)("aside",{className:"w-full md:w-64 shrink-0",children:(0,r.jsxs)("div",{className:"border-0 bg-secondary-light rounded-lg",children:[(0,r.jsx)("div",{className:"p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"h-12 w-12 rounded-full bg-primary-light flex items-center justify-center",children:(0,r.jsx)(i.A,{className:"h-6 w-6 text-secondary"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium",children:k.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Student"})]})]}),(0,r.jsx)("button",{className:"md:hidden p-2 rounded-md hover:bg-primary-light text-gray-700",onClick:()=>C(!I),"aria-label":"Toggle menu",children:I?(0,r.jsx)(d.A,{className:"h-5 w-5"}):(0,r.jsx)(l.A,{className:"h-5 w-5"})})]})}),(0,r.jsx)("div",{className:"p-0",children:(0,r.jsxs)("nav",{className:"space-y-1 p-4 ".concat(I?"block":"hidden"," md:block"),children:[(0,r.jsxs)(c(),{href:"/student",className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat("/student"===o?"bg-primary text-secondary font-medium":"hover:bg-primary-light text-gray-700 hover:text-secondary"),onClick:P,children:[(0,r.jsx)(u.A,{className:"h-5 w-5"}),"Dashboard"]}),(0,r.jsx)("div",{className:"pt-2 pb-1",children:(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3",children:"Learning"})}),(0,r.jsxs)(c(),{href:"/student/courses",className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat(o.startsWith("/student/courses")?"bg-primary text-secondary font-medium":"hover:bg-primary-light text-gray-700 hover:text-secondary"),onClick:P,children:[(0,r.jsx)(g.A,{className:"h-5 w-5"}),"My Courses"]}),(0,r.jsxs)(c(),{href:"/student/sessions",className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat(o.startsWith("/student/sessions")?"bg-primary text-secondary font-medium":"hover:bg-primary-light text-gray-700 hover:text-secondary"),onClick:P,children:[(0,r.jsx)(m.A,{className:"h-5 w-5"}),"Sessions"]}),(0,r.jsxs)(c(),{href:"/student/calendar",className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat(o.startsWith("/student/calendar")?"bg-primary text-secondary font-medium":"hover:bg-primary-light text-gray-700 hover:text-secondary"),onClick:P,children:[(0,r.jsx)(f.A,{className:"h-5 w-5"}),"Calendar"]}),(0,r.jsx)("div",{className:"pt-2 pb-1",children:(0,r.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3",children:"Account"})}),(0,r.jsxs)(c(),{href:"/student/payments",className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat(o.startsWith("/student/payments")?"bg-primary text-secondary font-medium":"hover:bg-primary-light text-gray-700 hover:text-secondary"),onClick:P,children:[(0,r.jsx)(h.A,{className:"h-5 w-5"}),"Payments"]}),(0,r.jsxs)(c(),{href:"/student/settings",className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat(o.startsWith("/student/settings")?"bg-primary text-secondary font-medium":"hover:bg-primary-light text-gray-700 hover:text-secondary"),onClick:P,children:[(0,r.jsx)(p.A,{className:"h-5 w-5"}),"Settings"]}),(0,r.jsxs)("div",{className:"pt-4 mt-4 border-t border-gray-200",children:[(0,r.jsxs)(c(),{href:"/student/help",className:"flex items-center gap-3 px-3 py-2 rounded-md ".concat(o.startsWith("/student/help")?"bg-primary text-secondary font-medium":"hover:bg-primary-light text-gray-700 hover:text-secondary"),onClick:P,children:[(0,r.jsx)(y.A,{className:"h-5 w-5"}),"Help Center"]}),(0,r.jsxs)(c(),{href:"/auth/logout",className:"flex items-center gap-3 px-3 py-2 rounded-md w-full text-left hover:bg-primary-light text-gray-700 hover:text-secondary",onClick:P,children:[(0,r.jsx)(x.A,{className:"h-5 w-5"}),"Logout"]})]})]})})]})}),(0,r.jsx)("div",{className:"flex-grow",children:t})]})})}),(0,r.jsx)(b.A,{}),(0,r.jsx)(w.l,{})]}):null}},69556:(e,t,s)=>{"use strict";s.d(t,{Ts:()=>i,VT:()=>c,Z1:()=>o,iw:()=>d,nm:()=>a,r2:()=>u,tS:()=>g,v2:()=>l,w0:()=>n});var r=s(15616);let a=async()=>{try{console.log("[students] Fetching students...");let e=await (0,r.P)("students");if(console.log("[students] Raw response from query():",e),Array.isArray(e))return console.log("[students] Fetched ".concat(e.length," students")),e;return console.warn("[students] Response is not an array:",e),[]}catch(e){return console.error("[students] Error fetching students:",e),[]}},n=async e=>await (0,r.P)("students/".concat(e),"GET"),o=async()=>{try{console.log("[students] Fetching current student info...");let e=await (0,r.Em)("students_page/getStudent","GET",void 0);if(e&&"OK"===e.status&&e.data)return console.log("[students] Current student fetched:",{id:e.data.id,name:e.data.name}),e.data;throw Error("Invalid response format for current student")}catch(e){throw console.error("[students] Error fetching current student:",e),e}};async function c(){try{console.log("[students] Fetching orders for current student...");let e=await (0,r.Em)("students_page/getOrders");if(e&&"OK"===e.status&&Array.isArray(e.data))return console.log("[students] Fetched ".concat(e.data.length," orders for current student")),e.data;return console.warn("[students] Invalid response format for student orders"),[]}catch(e){return console.error("[students] Error fetching orders for current student:",e),[]}}async function i(){try{console.log("[students] Fetching subscribed courses...");let e=await (0,r.Em)("students_page/getCourses");if(e&&"OK"===e.status&&Array.isArray(e.data))return console.log("[students] Fetched ".concat(e.data.length," subscribed courses")),e.data;return console.warn("[students] Invalid response format for subscribed courses"),[]}catch(e){return console.error("[students] Error fetching subscribed courses:",e),[]}}async function d(){try{console.log("[students] Fetching upcoming sessions...");let e=await (0,r.Em)("students_page/getUpcomingSessions");if(e&&"OK"===e.status&&Array.isArray(e.data))return console.log("[students] Fetched ".concat(e.data.length," upcoming sessions")),[...e.data].sort((e,t)=>new Date(e.scheduled_at).getTime()-new Date(t.scheduled_at).getTime());return console.warn("[students] Invalid response format for upcoming sessions"),[]}catch(e){return console.error("[students] Error fetching upcoming sessions:",e),[]}}async function l(){try{console.log("[students] Fetching all subscribed sessions...");let e=await (0,r.Em)("students_page/getClassSessions");if(e&&"OK"===e.status&&Array.isArray(e.data))return console.log("[students] Fetched ".concat(e.data.length," subscribed sessions")),e.data;return console.warn("[students] Invalid response format for subscribed sessions"),[]}catch(e){return console.error("[students] Error fetching subscribed sessions:",e),[]}}async function u(){try{console.log("[students] Fetching class attendances...");let e=await (0,r.Em)("students_page/getClassAttendances");if(e&&"OK"===e.status&&Array.isArray(e.data))return console.log("[students] Fetched ".concat(e.data.length," class attendances")),e.data;return console.warn("[students] Invalid response format for class attendances"),[]}catch(e){return console.error("[students] Error fetching class attendances:",e),[]}}let g={getAll:a,getById:n,getByUserId:async e=>(await (0,r.P)("students/byUserId/".concat(e),"GET")).data,getCurrent:o,create:async e=>(await (0,r.P)("students","POST",e)).data,update:async(e,t)=>(await (0,r.P)("students/".concat(e),"PUT",t)).data,delete:async e=>(await (0,r.P)("students/".concat(e),"DELETE"),!0),getOrders:c,getSubscribedCourses:i,getAllSessions:async function e(){try{console.log("[students] Fetching upcoming sessions...");let e=await (0,r.Em)("students_page/getAllSessions");if(e&&"OK"===e.status&&Array.isArray(e.data))return console.log("[students] Fetched ".concat(e.data.length," upcoming sessions")),[...e.data].sort((e,t)=>new Date(e.scheduled_at).getTime()-new Date(t.scheduled_at).getTime());return console.warn("[students] Invalid response format for upcoming sessions"),[]}catch(e){return console.error("[students] Error fetching upcoming sessions:",e),[]}},getUpcomingSessions:d,getAllSubscribedSessions:l,getClassAttendances:u}},79737:(e,t,s)=>{"use strict";s.d(t,{Qi:()=>n,_d:()=>a});let r="student_info",a=e=>{try{localStorage.setItem(r,JSON.stringify(e)),console.log("[storage] Student info stored:",{id:e.id,name:e.name})}catch(e){console.error("[storage] Failed to store student info:",e)}},n=()=>{try{let e=localStorage.getItem(r);if(e){let t=JSON.parse(e);return console.log("[storage] Student info retrieved:",{id:t.id,name:t.name}),t}return console.log("[storage] No student info found in localStorage"),null}catch(e){return console.error("[storage] Failed to retrieve student info:",e),null}}},84963:(e,t,s)=>{"use strict";s.d(t,{cn:()=>n});var r=s(12126),a=s(68441);function n(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.QP)((0,r.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[3438,1288,5281,7709,2105,8498,3981,4175,5616,7338,5022,5575,7358],()=>t(51988)),_N_E=e.O()}]);