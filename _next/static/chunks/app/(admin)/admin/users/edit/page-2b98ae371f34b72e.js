(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1285],{22438:(e,s,a)=>{"use strict";a.d(s,{J:()=>c});var r=a(2432),l=a(80364),i=a(86673),t=a(46992),d=a(84963);let n=(0,t.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(i.b,{ref:s,className:(0,d.cn)(n(),a),...l})});c.displayName=i.b.displayName},40264:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>j});var r=a(2432),l=a(80364),i=a(39262),t=a(63844),d=a(92260),n=a(77382),c=a(2708),o=a(87304),m=a(22438),u=a(45092),h=a(87759),x=a(57834),p=a(60219),f=a(41151);function j(e){let{params:s}=e,a=(0,i.useRouter)(),j=Number.parseInt(s.id),[b,v]=(0,l.useState)(!0),[g,N]=(0,l.useState)(null),[y,w]=(0,l.useState)([]),[k,R]=(0,l.useState)({name:"",email:"",status:"active",avatar:"",selectedRoles:[]});(0,l.useEffect)(()=>{(async()=>{try{v(!0);let[e,s,r]=await Promise.all([(0,x.kl)(j),(0,p.O0)(),(0,f.Rk)(j)]);if(!e){a.push("/admin/users");return}R({name:e.name||"",email:e.email||"",status:e.status||"active",avatar:e.avatar||"",selectedRoles:Array.isArray(r)?r.map(e=>e.id):[]}),w(Array.isArray(s)?s:[]),console.log("[user-edit][data]",{user:e,roles:s,userRoles:r})}catch(e){console.error("[user-edit][error]",e),N("Failed to load user data")}finally{v(!1)}})()},[j,a]);let C=e=>{let{name:s,value:a}=e.target;R(e=>({...e,[s]:a}))},A=e=>{R(s=>{let a=[...s.selectedRoles];return a.includes(e)?{...s,selectedRoles:a.filter(s=>s!==e)}:{...s,selectedRoles:[...a,e]}})},S=async e=>{e.preventDefault();try{v(!0),await (0,x.TK)(j,{name:k.name,email:k.email,status:k.status,avatar:k.avatar});let e=await (0,f.Rk)(j),s=Array.isArray(e)?e.map(e=>e.id):[],r=s.filter(e=>!k.selectedRoles.includes(e)),l=k.selectedRoles.filter(e=>!s.includes(e));await Promise.all([...r.map(e=>(0,f.Eo)(j,e)),...l.map(e=>(0,f.iz)(j,e))]),a.push("/admin/users/".concat(j))}catch(e){console.error("[user-edit][submit-error]",e),N("Failed to update user")}finally{v(!1)}};return b?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Loading user data..."})]})}):g?(0,r.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("p",{className:"text-red-600 mb-4",children:g}),(0,r.jsx)(c.$,{onClick:()=>window.location.reload(),children:"Retry"})]})}):(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsxs)(c.$,{variant:"ghost",className:"mb-4",onClick:()=>a.push("/admin/users/".concat(j)),children:[(0,r.jsx)(t.A,{className:"h-4 w-4 mr-2"}),"Back to User"]}),(0,r.jsx)("h1",{className:"text-3xl font-bold font-heading mb-2",children:"Edit User"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Update user information and roles"})]}),(0,r.jsxs)("form",{onSubmit:S,children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,r.jsxs)(n.Zp,{className:"border-0 bg-white lg:col-span-2",children:[(0,r.jsxs)(n.aR,{className:"pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-xl font-heading",children:"User Information"}),(0,r.jsx)(n.BT,{children:"Update the basic information for this user"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m.J,{htmlFor:"name",children:"Full Name"}),(0,r.jsx)(o.p,{id:"name",name:"name",placeholder:"Enter full name",value:k.name,onChange:C,required:!0})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m.J,{htmlFor:"email",children:"Email Address"}),(0,r.jsx)(o.p,{id:"email",name:"email",type:"email",placeholder:"Enter email address",value:k.email,onChange:C,required:!0})]})]}),(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(m.J,{htmlFor:"status",children:"Status"}),(0,r.jsxs)(u.l6,{value:k.status,onValueChange:e=>{R(s=>({...s,status:e}))},children:[(0,r.jsx)(u.bq,{id:"status",children:(0,r.jsx)(u.yv,{placeholder:"Select status"})}),(0,r.jsxs)(u.gC,{children:[(0,r.jsx)(u.eb,{value:"active",children:"Active"}),(0,r.jsx)(u.eb,{value:"inactive",children:"Inactive"}),(0,r.jsx)(u.eb,{value:"pending",children:"Pending"})]})]})]})})]})})]}),(0,r.jsxs)(n.Zp,{className:"border-0 bg-white",children:[(0,r.jsxs)(n.aR,{className:"pb-2",children:[(0,r.jsx)(n.ZB,{className:"text-xl font-heading",children:"Role Assignment"}),(0,r.jsx)(n.BT,{children:"Update roles for this user"})]}),(0,r.jsx)(n.Wu,{children:(0,r.jsx)("div",{className:"space-y-4",children:y.map(e=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h.S,{id:"role-".concat(e.id),checked:k.selectedRoles.includes(e.id),onCheckedChange:()=>A(e.id)}),(0,r.jsx)(m.J,{htmlFor:"role-".concat(e.id),className:"font-medium",children:e.display_name})]},e.id))})})]})]}),(0,r.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,r.jsx)(c.$,{type:"button",variant:"outline",onClick:()=>a.push("/admin/users/".concat(j)),children:"Cancel"}),(0,r.jsxs)(c.$,{type:"submit",disabled:b,children:[(0,r.jsx)(d.A,{className:"h-4 w-4 mr-2"}),b?"Saving...":"Save Changes"]})]})]})]})}},52274:(e,s,a)=>{Promise.resolve().then(a.bind(a,40264))},87304:(e,s,a)=>{"use strict";a.d(s,{p:()=>t});var r=a(2432),l=a(80364),i=a(84963);let t=l.forwardRef((e,s)=>{let{className:a,type:l,...t}=e;return(0,r.jsx)("input",{type:l,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...t})});t.displayName="Input"},87759:(e,s,a)=>{"use strict";a.d(s,{S:()=>n});var r=a(2432),l=a(80364),i=a(81109),t=a(33491),d=a(84963);let n=l.forwardRef((e,s)=>{let{className:a,...l}=e;return(0,r.jsx)(i.bL,{ref:s,className:(0,d.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...l,children:(0,r.jsx)(i.C1,{className:(0,d.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(t.A,{className:"h-4 w-4"})})})});n.displayName=i.bL.displayName}},e=>{var s=s=>e(e.s=s);e.O(0,[3438,5281,2092,978,6039,3628,5616,1361,5022,5575,7358],()=>s(52274)),_N_E=e.O()}]);