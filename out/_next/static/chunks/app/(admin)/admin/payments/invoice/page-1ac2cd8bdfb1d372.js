(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1131],{2708:(e,t,s)=>{"use strict";s.d(t,{$:()=>l,r:()=>o});var a=s(2432),n=s(80364),r=s(89932),i=s(46992),d=s(84963);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=n.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:l=!1,...c}=e,m=l?r.DX:"button";return(0,a.jsx)(m,{className:(0,d.cn)(o({variant:n,size:i,className:s})),ref:t,...c})});l.displayName="Button"},16765:(e,t,s)=>{"use strict";s.d(t,{E:()=>d});var a=s(2432);s(80364);var n=s(46992),r=s(84963);let i=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function d(e){let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:s}),t),...n})}},18144:(e,t,s)=>{Promise.resolve().then(s.bind(s,60860))},41969:(e,t,s)=>{"use strict";s.d(t,{Separator:()=>d});var a=s(2432),n=s(80364),r=s(52898),i=s(84963);let d=n.forwardRef((e,t)=>{let{className:s,orientation:n="horizontal",decorative:d=!0,...o}=e;return(0,a.jsx)(r.b,{ref:t,decorative:d,orientation:n,className:(0,i.cn)("shrink-0 bg-border","horizontal"===n?"h-[1px] w-full":"h-full w-[1px]",s),...o})});d.displayName=r.b.displayName},60860:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>P});var a=s(2432),n=s(80364),r=s(92105),i=s(39262),d=s(32317),o=s.n(d),l=s(77709),c=s(56708),m=s(63844),u=s(92539),x=s(67507),h=s(68057),f=s(32448),p=s(77382),v=s(2708),j=s(41969),y=s(16765),g=s(72569),N=s(15616);let b=async e=>await (0,N.P)("order_items","GET",{order_id:e});var w=s(77478);function P(e){let{params:t}=e,{t:s}=(0,r.Bd)(),d=(0,i.useRouter)(),N=Number.parseInt(t.id),[P,_]=(0,n.useState)(null),[C,E]=(0,n.useState)([]),[T,k]=(0,n.useState)(null),[S,R]=(0,n.useState)(!0);if((0,n.useEffect)(()=>{let e=g.Ww.find(e=>e.id===N);if(!e){d.push("/admin/payments");return}let t=b(N),s=(0,w.et)(N),a=s.length>0?s[0]:null;_(e),E(t),k(a),R(!1)},[N,d]),S)return(0,a.jsx)("div",{children:s("admin.loading","Loading...")});if(!P)return(0,a.jsx)("div",{children:s("admin.notFound","Invoice not found")});let I=e=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(e),B={line1:"789 Beijing Road",city:"Beijing",state:"Beijing",postalCode:"100000",country:"China"},D={name:"Customer #".concat(P.student_id),address:{line1:"Customer Address",city:"Customer City",state:"Customer State",postalCode:"000000",country:"China"}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(v.$,{variant:"ghost",size:"sm",asChild:!0,children:(0,a.jsxs)(o(),{href:"/admin/payments/detail?id=".concat(T?T.id:P.id),children:[(0,a.jsx)(m.A,{className:"h-4 w-4 mr-1"}),s("admin.invoice.backToPayment","Back to payment")]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(v.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(u.A,{className:"h-4 w-4 mr-1"}),s("admin.invoice.sendToCustomer","Send to Customer")]}),(0,a.jsxs)(v.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 mr-1"}),s("admin.invoice.print","Print")]}),(0,a.jsxs)(v.$,{variant:"outline",size:"sm",children:[(0,a.jsx)(h.A,{className:"h-4 w-4 mr-1"}),s("admin.invoice.download","Download PDF")]})]})]}),(0,a.jsx)(p.Zp,{className:"border-0 shadow-md bg-white",children:(0,a.jsx)(p.Wu,{className:"p-8",children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"h-12 w-48 relative mb-2",children:(0,a.jsx)(l.default,{src:"/world-mind-logo.png",alt:"WorldMind Logo",fill:!0,style:{objectFit:"contain"},className:"object-left"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:"WorldMind Education"}),(0,a.jsx)("p",{children:B.line1}),(0,a.jsxs)("p",{children:[B.city,", ",B.state," ",B.postalCode]}),(0,a.jsx)("p",{children:B.country})]})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-1",children:s("admin.invoice.invoice","INVOICE")}),(0,a.jsxs)("p",{className:"text-muted-foreground mb-4",children:["#",P.id]}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s("admin.invoice.issueDate","Issue Date"),":"]}),(0,a.jsx)("span",{children:(0,c.GP)(new Date(P.created_at),"PPP")})]}),(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s("admin.invoice.status","Status"),":"]}),(0,a.jsxs)(y.E,{className:"bg-green-100 text-green-700 hover:bg-green-100",children:[(0,a.jsx)(f.A,{className:"h-3 w-3 mr-1"}),P.payment_status.toUpperCase()]})]}),T&&(0,a.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s("admin.invoice.paymentDate","Payment Date"),":"]}),(0,a.jsx)("span",{children:(0,c.GP)(new Date(T.paid_at),"PPP")})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:s("admin.invoice.billTo","Bill To")}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsx)("p",{className:"font-medium",children:D.name}),(0,a.jsx)("p",{children:D.address.line1}),(0,a.jsxs)("p",{children:[D.address.city,", ",D.address.state," ",D.address.postalCode]}),(0,a.jsx)("p",{children:D.address.country})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-2",children:s("admin.invoice.paymentMethod","Payment Method")}),(0,a.jsx)("p",{children:T?T.method:s("admin.invoice.notSpecified","Not specified")}),(0,a.jsxs)("p",{className:"text-muted-foreground",children:[s("admin.invoice.orderNumber","Order Number"),": ",P.id]}),T&&(0,a.jsxs)("p",{className:"text-muted-foreground",children:[s("admin.invoice.reference","Reference"),": ",T.reference]})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("th",{className:"text-left py-3 font-semibold",children:s("admin.invoice.item","Item")}),(0,a.jsx)("th",{className:"text-right py-3 font-semibold",children:s("admin.invoice.quantity","Quantity")}),(0,a.jsx)("th",{className:"text-right py-3 font-semibold",children:s("admin.invoice.unitPrice","Unit Price")}),(0,a.jsx)("th",{className:"text-right py-3 font-semibold",children:s("admin.invoice.amount","Amount")})]})}),(0,a.jsx)("tbody",{children:C.length>0?C.map(e=>(0,a.jsxs)("tr",{className:"border-b",children:[(0,a.jsx)("td",{className:"py-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:e.item_type}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Item #",e.item_id]})]})}),(0,a.jsx)("td",{className:"py-4 text-right",children:e.quantity}),(0,a.jsx)("td",{className:"py-4 text-right",children:I(e.unit_price)}),(0,a.jsx)("td",{className:"py-4 text-right",children:I(e.total_price)})]},e.id)):(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:4,className:"py-4 text-center text-muted-foreground",children:s("admin.invoice.noItems","No items found for this order")})})})]})}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsxs)("div",{className:"w-64 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s("admin.invoice.subtotal","Subtotal"),":"]}),(0,a.jsx)("span",{children:I(P.total_amount)})]}),P.discount_amount>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsxs)("span",{className:"text-muted-foreground",children:[s("admin.invoice.discount","Discount"),":"]}),(0,a.jsxs)("span",{children:["-",I(P.discount_amount)]})]}),(0,a.jsx)(j.Separator,{}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold",children:[(0,a.jsxs)("span",{children:[s("admin.invoice.total","Total"),":"]}),(0,a.jsx)("span",{children:I(P.final_amount)})]}),T&&(0,a.jsxs)("div",{className:"flex justify-between font-semibold text-green-600",children:[(0,a.jsxs)("span",{children:[s("admin.invoice.amountPaid","Amount Paid"),":"]}),(0,a.jsx)("span",{children:I(T.amount_paid)})]})]})}),(0,a.jsxs)("div",{className:"border-t pt-6 text-center text-sm text-muted-foreground",children:[(0,a.jsxs)("p",{children:[s("admin.invoice.contactInfo","If you have any questions, please contact us at")," ","billing@worldmind.edu"," ",s("admin.invoice.or","or")," ","+86 10 1234 5678"]}),(0,a.jsx)("p",{className:"mt-1",children:s("admin.invoice.thankYou","Thank you for choosing WorldMind Education!")})]})]})})})]})}},72569:(e,t,s)=>{"use strict";s.d(t,{UY:()=>i,Uw:()=>r,Ww:()=>o,p:()=>n,ty:()=>d});var a=s(15616);let n=async e=>await (0,a.P)("orders/".concat(e),"GET"),r=async e=>await (0,a.Qi)("order/checkout","POST",e),i=async(e,t)=>(await (0,a.Em)("order/".concat(e,"/").concat(t),"GET")).data,d=async e=>{console.log("calculateOrder path:","order/calculate","data:",e);try{let t=await (0,a.Qi)("order/calculate","POST",e);return console.log("[calc][order]",{status:(null==t?void 0:t.status)||"unknown"}),t}catch(e){return console.error("calculateOrder error:",e),{status:"ERROR",message:"Calculation failed"}}},o={getAll:async()=>await (0,a.P)("orders","GET"),getById:n,getByStudentId:async e=>await (0,a.P)("orders","GET",{student_id:e}),create:async e=>await (0,a.P)("orders","POST",e),update:async(e,t)=>await (0,a.P)("orders/".concat(e),"PUT",t),delete:async e=>await (0,a.P)("orders/".concat(e),"DELETE"),checkout:r,enrollGet:i,calculate:d}},77382:(e,t,s)=>{"use strict";s.d(t,{BT:()=>l,Wu:()=>c,ZB:()=>o,Zp:()=>i,aR:()=>d,wL:()=>m});var a=s(2432),n=s(80364),r=s(84963);let i=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...n})});i.displayName="Card";let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex flex-col space-y-1.5 p-6",s),...n})});d.displayName="CardHeader";let o=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-2xl font-semibold leading-none tracking-tight",s),...n})});o.displayName="CardTitle";let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("text-sm text-muted-foreground",s),...n})});l.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("p-6 pt-0",s),...n})});c.displayName="CardContent";let m=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,a.jsx)("div",{ref:t,className:(0,r.cn)("flex items-center p-6 pt-0",s),...n})});m.displayName="CardFooter"},77478:(e,t,s)=>{"use strict";s.d(t,{_$:()=>r,et:()=>n});var a=s(15616);let n=async e=>{console.log("order_payments/query.ts","getPaymentsByOrderId/".concat(e),{orderId:e});let t=await (0,a.P)("order_payments",{order_id:e});return console.log("[payments][by-order]",{orderId:e,count:(null==t?void 0:t.length)||0}),t},r=async(e,t)=>{console.log("order_payments/query.ts","updatePayment/".concat(e),{id:e,...t});let s=await (0,a.yo)("order_payments",e,t);return console.log("[payment][update]",{id:null==s?void 0:s.id,status:null==s?void 0:s.status}),s}},84963:(e,t,s)=>{"use strict";s.d(t,{cn:()=>r});var a=s(12126),n=s(68441);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[3438,1288,7709,2105,9981,5616,5022,5575,7358],()=>t(18144)),_N_E=e.O()}]);